<!DOCTYPE html> 
<html> 
	<head> 
	<title>My Page</title> 
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.css" />
	<link rel="stylesheet" type="text/css" href="style.css">
	<script type="text/javascript" src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
	<script type="text/javascript" src="http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.js"></script>

	<script type="text/javascript">
		var couponstuff;
		var runfunction;
		var count = 0;
		var datastructure = [];
		var client = new XMLHttpRequest();
		client.open('GET', '/coupons.csv');
		client.onreadystatechange = function() {
			couponstuff = client.responseText
		  	runfunction();

		}
		client.send();

		//gets called after the csv has been loaded in
		runfunction = function(){
			var partofstring = couponstuff.split(',');
			if (partofstring[1]!=null && count==0) {
				for (var i = 0; i < partofstring.length; i++) {
					partofstring[i] = partofstring[i].replace('"','');
				};
				for (var i = 0; i < ((partofstring.length)/4); i++) {
							datastructure.push({
								store: partofstring[(i*4)],
								category: partofstring[(i*4)+1],
								expirationdate: partofstring[(i*4)+2],
								specifics: partofstring[(i*4)+3]
						})
					

				};
				console.log(datastructure)
				count++;
			};
		}

		
	</script>

</head> 
<body id="mainpage"> 

<div data-role="page" >

	<div data-role="header">
		<a href="information.html" data-transition="slide" data-icon="info" class="ui-btn-right">Information</a>
		<h1>Crazy Coupons</h1>
		<a href="options.html" data-transition="slide" data-direction="reverse" data-icon="gear" class="ui-btn-left">Options</a>
	</div><!-- /header -->

	<div data-role="content">	
		<div data-role="controlgroup" data-type="horizontal" style="text-align:center;">
			<a href="index.html" data-transition="fade" data-role="button" data-icon="home" data-theme="b">Home</a>
			<a href="map.html" data-transition="fade" data-role="button" data-icon="navigation">Map</a>
			<a href="trending.html" data-transition="fade" data-role="button" data-icon="star">Trending</a>
			<a href="camera.html" data-transition="fade" data-role="button" data-icon="camera">Camera</a>
		</div>		


		<form>
			<div class="ui-field-contain">
	    		<label align="center" for="select-native-2">Sort By:</label>
			    <select name="select-native-2" id="select-native-2" data-mini="true">
			        <option value="1">Expiration Date</option>
			        <option value="2">Food</option>
			        <option value="3">Clothing</option>
			        <option value="4">Produce</option>
			    </select>
			</div>
		</form>


		<ul data-role="listview" data-inset="true" data-filter="true">
			<li><a href="#">
				<h1>CVS</h1>
				<h2>$3.00 ExtraBucks</h2>
				<h3 class="ui-li-aside">4/20/16</h3>
			</a></li>
			<li><a href="#">
				<h1>Macy's</h1>
				<h2>50% Off Sale</h2>
				<h3 class="ui-li-aside">4/25/16</h3>
			</a></li>
			<li><a href="#">
				<h1>Best Buy</h1>
				<h2>$10 Off Your $50 Purchase</h2>
				<h3 class="ui-li-aside">5/1/16</h3>
			</a></li>
			<li><a href="#">
				<h1>El Jeffe's</h1>
				<h2>Free Burrito</h2>
				<h3 class="ui-li-aside">5/2/16</h3>
			</a></li>
			<li><a href="#">
				<h1>Gyu-Kaku</h1>
				<h2>Complimentary Side Dish</h2>
				<h3 class="ui-li-aside">5/5/16</h3>
			</a></li>
		</ul>
	</div><!-- /content -->

</div><!-- /page -->

</body>
</html>